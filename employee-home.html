<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn - Home</title>
    <link rel="stylesheet" href="employee-home.css" />
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <a href="#" class="logo">in</a>
            
            <div class="search-bar">
                <span class="search-icon">üîç</span>
                <input type="text" placeholder="Search">
            </div>
            
            <div class="nav-icons">
                <a href="#" class="nav-icon">
                    <span class="icon">üè†</span>
                    <span>Home</span>
                </a>
                <a href="networks.html" class="nav-icon">
                    <span class="icon">üë•</span>
                    <span>Network</span>
                </a>
                <a href="employee-browse-jobs.html" class="nav-icon">
                    <span class="icon">üíº</span>
                    <span>Jobs</span>
                </a>
                <a href="messages.html" class="nav-icon">
                    <span class="icon">üí¨</span>
                    <span>Messages</span>
                </a>
                <a href="notification.html" class="nav-icon">
                    <span class="icon">üîî</span>
                    <span>Notifications</span>
                </a>
                <a href="index.html" class="nav-icon">
                    <span class="icon">üö™</span>
                    <span>Logout</span>
                </a>
                <a href="#">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e6662dd6-0f76-4260-a025-d67ce7e2e9bf.png" alt="User profile picture - professional headshot of a business person" class="profile-img">
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="profile-card">
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/3166fb72-9238-407d-aa11-8a1711bab584.png" alt="User profile avatar - professional headshot with beige background" class="profile-avatar">
                <h3 class="profile-name">Sarah Johnson</h3>
                <p class="profile-title">Senior Software Engineer at TechCorp</p>
                
                <div class="profile-stats">
                    <div class="stat">
                        <div class="stat-number">543</div>
                        <div class="stat-label">Connections</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">89</div>
                        <div class="stat-label">Views</div>
                    </div>
                </div>
                
                <button class="btn-primary" onclick="window.location.href='profile.html'">View Profile</button>
            </div>

            <div class="sidebar-section">
                <h4 class="sidebar-title">Recent</h4>
                <a href="#" class="sidebar-item">
                    <span class="icon">üîç</span>
                    <span>Web Developer</span>
                </a>
                <a href="#" class="sidebar-item">
                    <span class="icon">üîç</span>
                    <span>UX Designer</span>
                </a>
                <a href="#" class="sidebar-item">
                    <span class="icon">üîç</span>
                    <span>Remote Jobs</span>
                </a>
            </div>

            <div class="sidebar-section">
                <h4 class="sidebar-title">Groups</h4>
                <a href="#" class="sidebar-item">
                    <span class="icon">üë•</span>
                    <span>Tech Professionals</span>
                </a>
                <a href="#" class="sidebar-item">
                    <span class="icon">üë•</span>
                    <span>Startup Founders</span>
                </a>
                <a href="#" class="sidebar-item">
                    <span class="icon">üë•</span>
                    <span>Digital Marketing</span>
                </a>
            </div>

            <div class="sidebar-section">
                <h4 class="sidebar-title">Hashtags</h4>
                <a href="#" class="sidebar-item">
                    <span class="icon">#</span>
                    <span>WebDevelopment</span>
                </a>
                <a href="#" class="sidebar-item">
                    <span class="icon">#</span>
                    <span>TechJobs</span>
                </a>
                <a href="#" class="sidebar-item">
                    <span class="icon">#</span>
                    <span>RemoteWork</span>
                </a>
            </div>
        </aside>

        <!-- Feed -->
        <section class="feed">
            <div class="create-post">
                <div class="post-input">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/273893e1-cb31-46c5-b38f-54cd8b4e1dc6.png" alt="Your profile picture thumbnail">
                    <input type="text" placeholder="Start a post">
                </div>
                <div class="post-actions">
                    <a href="#" class="post-action">
                        <span class="icon">üñºÔ∏è</span>
                        <span>Media</span>
                    </a>
                    <a href="#" class="post-action">
                        <span class="icon">üìÖ</span>
                        <span>Event</span>
                    </a>
                    <a href="#" class="post-action">
                        <span class="icon">üìù</span>
                        <span>Article</span>
                    </a>
                </div>
            </div>

            <!-- Post 1 -->
            <div class="post">
                <div class="post-header">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/04513847-d56e-451a-850e-369d6b7261fa.png" alt="Profile picture of Michael Chen - software engineer" class="post-avatar">
                    <div class="post-user-info">
                        <div class="post-username">Michael Chen</div>
                        <div class="post-user-title">Software Engineer at Google</div>
                        <div class="post-time">3h ago</div>
                    </div>
                </div>
                <div class="post-content">
                    Just wrapped up an amazing project using React and Node.js! The team did an incredible job delivering this complex application ahead of schedule. üöÄ
                    
                    Key features we implemented:
                    - Real-time collaboration
                    - Advanced analytics dashboard
                    - Mobile-responsive design
                    
                    #WebDevelopment #React #NodeJS
                </div>
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/31aa8474-b7c1-4f55-b238-2b460e52412e.png" alt="Code editor screenshot showing React components and clean code structure" class="post-image">
                <div class="post-stats">
                    <span>üëç 128 likes</span>
                    <span>üí¨ 24 comments</span>
                </div>
                <div class="post-buttons">
                    <a href="#" class="post-button">
                        <span class="icon">üëç</span>
                        <span>Like</span>
                    </a>
                    <a href="#" class="post-button">
                        <span class="icon">üí¨</span>
                        <span>Comment</span>
                    </a>
                    <a href="#" class="post-button">
                        <span class="icon">‚ÜóÔ∏è</span>
                        <span>Share</span>
                    </a>
                </div>
            </div>

            <!-- Post 2 -->
            <div class="post">
                <div class="post-header">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/23749e71-2981-4934-a062-bbfee7fa8845.png" alt="Profile picture of Emily Rodriguez - product manager" class="post-avatar">
                    <div class="post-user-info">
                        <div class="post-username">Emily Rodriguez</div>
                        <div class="post-user-title">Product Manager at StartupX</div>
                        <div class="post-time">5h ago</div>
                    </div>
                </div>
                <div class="post-content">
                    Thrilled to announce that our team is hiring! We're looking for passionate Frontend Developers to join our growing team. If you love working with modern JavaScript frameworks and care about user experience, this might be the perfect opportunity for you.
                    
                    ‚úÖ React/Vue experience
                    ‚úÖ CSS expertise
                    ‚úÖ 3+ years professional experience
                    
                    DM me if you're interested! #Hiring #Frontend #TechJobs
                </div>
                <div class="post-stats">
                    <span>üëç 89 likes</span>
                    <span>üí¨ 15 comments</span>
                </div>
                <div class="post-buttons">
                    <a href="#" class="post-button">
                        <span class="icon">üëç</span>
                        <span>Like</span>
                    </a>
                    <a href="#" class="post-button">
                        <span class="icon">üí¨</span>
                        <span>Comment</span>
                    </a>
                    <a href="#" class="post-button">
                        <span class="icon">‚ÜóÔ∏è</span>
                        <span>Share</span>
                    </a>
                </div>
            </div>

            <!-- Post 3 -->
            <div class="post">
                <div class="post-header">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/7fe414b5-451f-4a9f-92ee-8947779982c0.png" alt="Profile picture of David Kim - UX designer" class="post-avatar">
                    <div class="post-user-info">
                        <div class="post-username">David Kim</div>
                        <div class="post-user-title">UX Designer at CreativeLabs</div>
                        <div class="post-time">8h ago</div>
                    </div>
                </div>
                <div class="post-content">
                    Just published a new case study on designing for accessibility! In this article, I break down how we improved our product's accessibility score by 45% while maintaining aesthetic appeal.
                    
                    Key takeaways:
                    - Color contrast matters more than you think
                    - Keyboard navigation is non-negotiable
                    - Screen reader compatibility opens your product to millions
                    
                    Link in comments! #UXDesign #Accessibility #InclusiveDesign
                </div>
                <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/61c616c2-4620-41b0-ad67-9f8122f79292.png" alt="Before and after comparison of website accessibility improvements showing better contrast and navigation" class="post-image">
                <div class="post-stats">
                    <span>üëç 156 likes</span>
                    <span>üí¨ 32 comments</span>
                </div>
                <div class="post-buttons">
                    <a href="#" class="post-button">
                        <span class="icon">üëç</span>
                        <span>Like</span>
                    </a>
                    <a href="#" class="post-button">
                        <span class="icon">üí¨</span>
                        <span>Comment</span>
                    </a>
                    <a href="#" class="post-button">
                        <span class="icon">‚ÜóÔ∏è</span>
                        <span>Share</span>
                    </a>
                </div>
            </div>
        </section>

        <!-- Right Sidebar -->
        <aside class="right-sidebar">
            <div class="news-card">
                <div class="news-header">
                    <h4 class="news-title">LinkedIn News</h4>
                    <span class="icon">‚öôÔ∏è</span>
                </div>
                <div class="news-item">
                    <div class="news-topic">Remote work trends in 2024</div>
                    <div class="news-time">2h ago ‚Ä¢ 1,284 readers</div>
                </div>
                <div class="news-item">
                    <div class="news-topic">AI skills in high demand</div>
                    <div class="news-time">4h ago ‚Ä¢ 3,452 readers</div>
                </div>
                <div class="news-item">
                    <div class="news-topic">Tech hiring slows slightly</div>
                    <div class="news-time">6h ago ‚Ä¢ 892 readers</div>
                </div>
                <div class="news-item">
                    <div class="news-topic">Web3 developer opportunities</div>
                    <div class="news-time">8h ago ‚Ä¢ 1,567 readers</div>
                </div>
            </div>

            <div class="ad-card">
                <h3 class="ad-title">Premium Membership</h3>
                <p>Get hired faster with Premium</p>
                <button class="ad-button">Try Free for 1 Month</button>
            </div>

            <div class="news-card">
                <div class="news-header">
                    <h4 class="news-title">Today's Top Courses</h4>
                </div>
                <div class="news-item">
                    <div class="news-topic">React Masterclass 2024</div>
                    <div class="news-time">12,345 learners</div>
                </div>
                <div class="news-item">
                    <div class="news-topic">Advanced JavaScript Patterns</div>
                    <div class="news-time">8,912 learners</div>
                </div>
                <div class="news-item">
                    <div class="news-topic">Cloud Architecture Fundamentals</div>
                    <div class="news-time">6,784 learners</div>
                </div>
            </div>
        </aside>
    </main>

    <script>
// ========================================
// EMPLOYEE HOME - POSTS FEED INTEGRATION
// ========================================

// Utility functions
function getToken() { return localStorage.getItem('token'); }
function getCurrentUser() { return JSON.parse(localStorage.getItem('user') || '{}'); }
function protectPage() { if (!getToken()) window.location.href = 'index.html'; }

async function apiRequest(endpoint, options = {}) {
  const token = getToken();
  const config = { ...options, headers: { 'Content-Type': 'application/json', ...(token && { 'Authorization': `Bearer ${token}` }), ...options.headers }};
  const response = await fetch(`/api${endpoint}`, config);
  const data = await response.json();
  if (!response.ok) { if (response.status === 401) { localStorage.clear(); window.location.href = 'index.html'; } throw new Error(data.error || 'Failed'); }
  return data;
}

function showToast(msg, type='success') {
  const t = document.createElement('div');
  t.textContent = msg;
  t.style.cssText = `position:fixed;top:20px;right:20px;background:${type==='success'?'#4CAF50':'#f44336'};color:white;padding:16px 24px;border-radius:8px;z-index:10000;`;
  document.body.appendChild(t);
  setTimeout(() => t.remove(), 3000);
}

function formatTime(date) {
  const diff = Date.now() - new Date(date);
  const hours = Math.floor(diff/3600000);
  const days = Math.floor(hours/24);
  if (hours < 24) return `${hours}h ago`;
  if (days < 7) return `${days}d ago`;
  return new Date(date).toLocaleDateString();
}

protectPage();

// Load posts from backend
async function loadPosts() {
  try {
    const data = await apiRequest('/posts/feed?page=1&limit=10');
    const feedSection = document.querySelector('.feed');
    const createPostDiv = feedSection.querySelector('.create-post');
    
    // Clear existing posts but keep create-post
    const posts = feedSection.querySelectorAll('.post');
    posts.forEach(p => p.remove());
    
    // Add posts from backend
    data.posts.forEach(post => {
      const postDiv = document.createElement('div');
      postDiv.className = 'post';
      postDiv.innerHTML = `
        <div class="post-header">
          <img src="${post.author.profileImage || 'https://placehold.co/48x48'}" alt="${post.author.firstName} ${post.author.lastName}" class="post-avatar">
          <div class="post-user-info">
            <div class="post-username">${post.author.firstName} ${post.author.lastName}</div>
            <div class="post-user-title">${post.author.headline || 'Professional'}</div>
            <div class="post-time">${formatTime(post.createdAt)}</div>
          </div>
        </div>
        <div class="post-content">${post.content}</div>
        <div class="post-stats">
          <span>üëç ${post.likesCount || 0} likes</span>
          <span>üí¨ ${post.commentsCount || 0} comments</span>
        </div>
        <div class="post-buttons">
          <a href="#" class="post-button like-btn" data-post-id="${post._id}" data-liked="${post.isLikedByUser}">
            <span class="icon">${post.isLikedByUser ? 'üëç' : 'üëç'}</span>
            <span>${post.isLikedByUser ? 'Liked' : 'Like'}</span>
          </a>
          <a href="#" class="post-button comment-btn" data-post-id="${post._id}">
            <span class="icon">üí¨</span>
            <span>Comment</span>
          </a>
          <a href="#" class="post-button">
            <span class="icon">‚ÜóÔ∏è</span>
            <span>Share</span>
          </a>
        </div>
        <div class="comment-section" id="comment-${post._id}" style="display:none;padding:1rem;border-top:1px solid #e0d9c7;">
          <input type="text" placeholder="Write a comment..." style="width:100%;padding:0.8rem;border:1px solid #e0d9c7;border-radius:8px;margin-bottom:0.5rem;">
          <button onclick="addComment('${post._id}')" class="btn" style="padding:0.5rem 1rem;background:#b0a080;color:white;border:none;border-radius:6px;cursor:pointer;">Post Comment</button>
        </div>
      `;
      
      if (post.isLikedByUser) {
        postDiv.querySelector('.like-btn').style.color = '#b0a080';
      }
      
      feedSection.appendChild(postDiv);
    });
    
    // Attach like handlers
    document.querySelectorAll('.like-btn').forEach(btn => {
      btn.addEventListener('click', async function(e) {
        e.preventDefault();
        const postId = this.dataset.postId;
        const isLiked = this.dataset.liked === 'true';
        
        try {
          await apiRequest(`/posts/${postId}/like`, { method: 'POST' });
          this.dataset.liked = !isLiked;
          this.querySelector('span:last-child').textContent = isLiked ? 'Like' : 'Liked';
          this.style.color = isLiked ? '#666' : '#b0a080';
          loadPosts(); // Refresh to update counts
        } catch (err) {
          showToast('Failed to like post', 'error');
        }
      });
    });
    
    // Attach comment handlers
    document.querySelectorAll('.comment-btn').forEach(btn => {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        const commentSection = document.getElementById(`comment-${this.dataset.postId}`);
        commentSection.style.display = commentSection.style.display === 'none' ? 'block' : 'none';
      });
    });
    
  } catch (error) {
    console.error('Failed to load posts:', error);
    showToast('Failed to load posts', 'error');
  }
}

// Create new post
async function createPost(content) {
  if (!content.trim()) return;
  
  try {
    await apiRequest('/posts', { 
      method: 'POST', 
      body: JSON.stringify({ content: content.trim(), postType: 'text', visibility: 'public' }) 
    });
    showToast('Post created!');
    loadPosts();
  } catch (error) {
    showToast('Failed to create post', 'error');
  }
}

// Add comment
window.addComment = async function(postId) {
  const commentSection = document.getElementById(`comment-${postId}`);
  const input = commentSection.querySelector('input');
  const content = input.value.trim();
  
  if (!content) return;
  
  try {
    await apiRequest(`/posts/${postId}/comment`, { 
      method: 'POST', 
      body: JSON.stringify({ content }) 
    });
    input.value = '';
    showToast('Comment added!');
    loadPosts();
  } catch (error) {
    showToast('Failed to add comment', 'error');
  }
};

// Handle post creation
const postInput = document.querySelector('.post-input input');
if (postInput) {
  postInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter' && this.value.trim()) {
      createPost(this.value);
      this.value = '';
    }
  });
}

// Initial load
loadPosts();
</script>
</body>
</html>

